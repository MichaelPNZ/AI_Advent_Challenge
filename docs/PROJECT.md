# AI Advent Challenge — документация проекта

## Что делает приложение
- Чат‑ассистент с MCP‑инструментами: погода, World Bank, напоминания, сводки, doc pipeline, RAG по локальным документам.
- RAG режим: при включении берёт вопрос, ищет релевантные чанки в индексе, отвечает с указанием источников.
- Индексация: поддерживает txt/md/pdf/docx и файлы кода/конфигов (kt/kts/java/xml/json/yaml/yml/gradle/properties/csv/sh). Индекс пишется в `~/.ai_advent/embedding_index/index.jsonl` (append).

## Основные сценарии
- **/help** — вопрос о проекте с использованием RAG (README + docs).
- **Индексация** — кнопка с папкой на экране списка чатов: выберите папку, проиндексируются все поддерживаемые файлы.
- **RAG toggle** — в настройках чата включить RAG и при необходимости задать порог релевантности (0.0–1.0).
- **RAG ответ** — при включённом RAG отправка вопроса очищает поле, пишет сообщение пользователя, показывает «RAG: думаю…», затем ответ с источниками.

## MCP инструменты
- weather, worldbank, reminder, chat-summary, doc-pipeline.
- git_branch (локальный): отдаёт текущую git‑ветку через `git branch --show-current`.

## Настройки RAG
- Порог релевантности (по косинусу) задаётся в настройках чата.
- Контекст: топ‑K (3) чанков, плюс отфильтрованные по порогу.
- Промпт требует указывать источники в формате `[Источник: <имя файла>]`.

## Где смотреть код
- Индексация: `desktopApp/.../embedding/EmbeddingIndexService.kt`
- RAG сравнение: `desktopApp/.../embedding/RagComparisonService.kt`
- Чат + RAG режим: `features/chat/.../ChatComponent.kt`, UI — `ChatScreen.kt`
- MCP регистрация: `desktopApp/.../di/DesktopModules.kt`

## Быстрый старт
1) Убедитесь, что запущен `ollama serve` и скачана модель `nomic-embed-text`.
2) В списке чатов нажмите «Индексировать» → выберите папку (README + docs).
3) В настройках чата включите RAG и задайте порог (например, 0.25).
4) Задайте вопрос или `/help <вопрос>` — получите ответ с источниками.
